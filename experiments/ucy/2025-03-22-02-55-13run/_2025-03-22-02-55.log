2025-03-22-02-55-13
Config:
('lr', 0.005)
('nei_padding_mask', True)
('batch_size', 32)
('train_data_ratio', 1)
('diffusion_steps', 50)
('variance_mode', 'linear')
('val_mode', 'multistep')
('diffnet', 'Diffuser_ped_inter_geometric_cond_w_history')
('yt_encoder_layers', 3)
('spatial_emsize', 128)
('spatial_encoder_head', 4)
('spatial_encoder_layers', 2)
('dropout', 0.3)
('esti_goal', 'acce')
('history_dim', 6)
('history_emsize', 64)
('history_lstm', 128)
('history_lstm_out', 64)
('ped_encode_dim1', 64)
('ped_encode_hid1', [64, 64])
('ped_encode_dim2', 64)
('ped_encode2_layers', 4)
('egnn_layers', 3)
('egnn_hid_dim', 64)
('obs_seq_len', 8)
('pred_seq_len', 20)
('epochs', -1)
('save_model', True)
('finetune', True)
('total_epochs', 160)
('data_config', 'configs/data_configs/data_finetune_ucy.yaml')
('rebuild_dataset', True)
('data_dict_path', 'dataset_built/pretrain_ucy_0403_trainonreal_mt_fn10_t3v1.pkl')
('model_sd_path', False)
('finetune_trainmode', 'multistep')
('time_decay', 0.9)
('use_col_focus_loss', False)
('collision_threshold', 0.5)
('dataset_type', 'timeindex')
('finetune_flag', 1)
('valid_steps', 10)
('data_dir', 'processed_data_sf')
('topk_ped', 6)
('sight_angle_ped', 90)
('dist_threshold_ped', 4)
('topk_obs', 10)
('sight_angle_obs', 90)
('dist_threshold_obs', 4)
('skip_frames', 25)
('num_history_feature', 8)
('num_history_velocity', 1)
('train_mode', 'multi')
('eval_batch_size', 256)
('k_eval', 25)
('seed', 666)
('eval_every', 10)
('eval_at', 80)
('eval_mode', False)
('device', 'cuda')
('note', 'None')
('config', 'configs/ucy.yaml')
('dataset', '')
('exp_name', 'ucy')


Eval on:



#Trainable Parameters: 226536


('ft_lr', 5e-05)
Epoch 0 MSE: 16.282407760620117 MAE: 2.6992409229278564
Epoch 0 OT: 7.705137498529444 MMD: 0.16520470112242217
Epoch 0 collision: 274.0 FDE: 3.112912654876709
Epoch 0 dtw: 1.138425806798389 inter ped distance mmd: 0.339585495584193
 
Epoch 10 MSE: 11.272418975830078 MAE: 2.0345304012298584
Epoch 10 OT: 4.9612913231154945 MMD: 0.07658414966055403
Epoch 10 collision: 454.0 FDE: 2.1129558086395264
Epoch 10 dtw: 0.7935076338178086 inter ped distance mmd: 0.24330702274352128
 
Epoch 20 MSE: 10.578286170959473 MAE: 1.940995454788208
Epoch 20 OT: 4.507723874734734 MMD: 0.0729198507118993
Epoch 20 collision: 584.0 FDE: 1.9642425775527954
Epoch 20 dtw: 0.7561564942317032 inter ped distance mmd: 0.22448796978894553
 
Epoch 30 MSE: 9.813268661499023 MAE: 1.8505558967590332
Epoch 30 OT: 4.069507643212593 MMD: 0.07052117859819002
Epoch 30 collision: 636.0 FDE: 1.8641425371170044
Epoch 30 dtw: 0.729768331084296 inter ped distance mmd: 0.23050303028416505
 
Epoch 40 MSE: 9.634946823120117 MAE: 1.8749275207519531
Epoch 40 OT: 3.909000173276241 MMD: 0.07170588799689445
Epoch 40 collision: 642.0 FDE: 1.902222990989685
Epoch 40 dtw: 0.7220417334236832 inter ped distance mmd: 0.26177895804467194
 
Epoch 50 MSE: 9.799141883850098 MAE: 1.9189741611480713
Epoch 50 OT: 4.00812064289549 MMD: 0.07222433690484499
Epoch 50 collision: 640.0 FDE: 1.9176095724105835
Epoch 50 dtw: 0.7220424857234287 inter ped distance mmd: 0.26271102431464505
 
Epoch 60 MSE: 10.106566429138184 MAE: 1.9683486223220825
Epoch 60 OT: 4.227657815265008 MMD: 0.07690641554815272
Epoch 60 collision: 566.0 FDE: 1.9381768703460693
Epoch 60 dtw: 0.7278945553595217 inter ped distance mmd: 0.2551618740591078
 
Epoch 70 MSE: 10.420753479003906 MAE: 2.0040700435638428
Epoch 70 OT: 4.4479144123958685 MMD: 0.08198346802107762
Epoch 70 collision: 574.0 FDE: 1.9598259925842285
Epoch 70 dtw: 0.7381789374086901 inter ped distance mmd: 0.2515933515184039
 
Epoch 80 MSE: 10.668779373168945 MAE: 2.0307085514068604
Epoch 80 OT: 4.573703853645775 MMD: 0.08659750568834733
Epoch 80 collision: 560.0 FDE: 1.91647469997406
Epoch 80 dtw: 0.7543768170768412 inter ped distance mmd: 0.24663755691901673
 
Epoch 90 MSE: 10.89501953125 MAE: 2.0506908893585205
Epoch 90 OT: 4.65288638130279 MMD: 0.08979030061467476
Epoch 90 collision: 586.0 FDE: 1.9210469722747803
Epoch 90 dtw: 0.7679157822140467 inter ped distance mmd: 0.23844162695269827
 
Epoch 100 MSE: 11.165213584899902 MAE: 2.0736563205718994
Epoch 100 OT: 4.767825655019661 MMD: 0.09280135950496408
Epoch 100 collision: 576.0 FDE: 1.939016580581665
Epoch 100 dtw: 0.785882738427581 inter ped distance mmd: 0.22984519818557736
 
Epoch 110 MSE: 11.355171203613281 MAE: 2.094697952270508
Epoch 110 OT: 4.826947954607127 MMD: 0.09463942473171497
Epoch 110 collision: 612.0 FDE: 1.9617869853973389
Epoch 110 dtw: 0.7994562170215856 inter ped distance mmd: 0.22960133829719723
 
Epoch 120 MSE: 11.711721420288086 MAE: 2.137083053588867
Epoch 120 OT: 4.897209174832907 MMD: 0.09909079054747623
Epoch 120 collision: 632.0 FDE: 1.9981069564819336
Epoch 120 dtw: 0.8165447101623655 inter ped distance mmd: 0.2299217684880082
 
Epoch 130 MSE: 12.164159774780273 MAE: 2.1938254833221436
Epoch 130 OT: 4.927746723786392 MMD: 0.10623111472425102
Epoch 130 collision: 664.0 FDE: 2.024782657623291
Epoch 130 dtw: 0.8399322261320097 inter ped distance mmd: 0.24584252067893012
 
Epoch 140 MSE: 12.566010475158691 MAE: 2.2407314777374268
Epoch 140 OT: 4.942161787652841 MMD: 0.11189081666111214
Epoch 140 collision: 676.0 FDE: 2.0575177669525146
Epoch 140 dtw: 0.8586990524814507 inter ped distance mmd: 0.24550852578339036
 
Epoch 150 MSE: 13.099209785461426 MAE: 2.300511598587036
Epoch 150 OT: 5.045614395226039 MMD: 0.11849391863801362
Epoch 150 collision: 628.0 FDE: 2.1003963947296143
Epoch 150 dtw: 0.8876787062699549 inter ped distance mmd: 0.23429222960893545
 
Epoch 160 MSE: 13.612151145935059 MAE: 2.354755163192749
Epoch 160 OT: 5.195421131127386 MMD: 0.12594372635718687
Epoch 160 collision: 612.0 FDE: 2.1239449977874756
Epoch 160 dtw: 0.9099024481305452 inter ped distance mmd: 0.25657385217448686
 
