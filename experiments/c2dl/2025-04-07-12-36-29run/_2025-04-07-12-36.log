2025-04-07-12-36-29
Config:
('lr', 0.0005)
('nei_padding_mask', True)
('batch_size', 32)
('train_data_ratio', 1)
('diffusion_steps', 50)
('variance_mode', 'linear')
('val_mode', 'multistep')
('diffnet', 'Diffuser_ped_inter_geometric_cond_w_history')
('yt_encoder_layers', 3)
('spatial_emsize', 128)
('spatial_encoder_head', 4)
('spatial_encoder_layers', 2)
('dropout', 0.3)
('esti_goal', 'acce')
('history_dim', 6)
('history_emsize', 64)
('history_lstm', 128)
('history_lstm_out', 64)
('ped_encode_dim1', 64)
('ped_encode_hid1', [64, 64])
('ped_encode_dim2', 64)
('ped_encode2_layers', 4)
('egnn_layers', 3)
('egnn_hid_dim', 64)
('obs_seq_len', 8)
('pred_seq_len', 20)
('epochs', -1)
('save_model', True)
('finetune', True)
('total_epochs', 30)
('data_config', 'configs/data_configs/data_finetune_c2dl.yaml')
('rebuild_dataset', True)
('data_dict_path', 'dataset_built/pretrain_ucy_0403_trainonreal_mt_fn10_t3v1.pkl')
('model_sd_path', False)
('finetune_trainmode', 'multistep')
('time_decay', 0.9)
('use_col_focus_loss', False)
('collision_threshold', 0.5)
('dataset_type', 'timeindex')
('finetune_flag', 1)
('valid_steps', 10)
('data_dir', 'processed_data_sf')
('topk_ped', 6)
('sight_angle_ped', 90)
('dist_threshold_ped', 4)
('topk_obs', 5)
('sight_angle_obs', 90)
('dist_threshold_obs', 4)
('skip_frames', 25)
('num_history_feature', 8)
('num_history_velocity', 1)
('train_mode', 'multi')
('eval_batch_size', 256)
('k_eval', 25)
('seed', 666)
('eval_every', 10)
('eval_at', 80)
('eval_mode', False)
('device', 'cuda')
('note', 'None')
('config', 'configs/c2dl.yaml')
('dataset', '')
('exp_name', 'c2dl')


Eval on:



#Trainable Parameters: 226536


('ft_lr', 5e-06)
Epoch 0 MSE: 4582.48095703125 MAE: 53.94922637939453
Epoch 0 OT: 1091.782642574905 MMD: 0.47669683082355296
Epoch 0 collision: 0.0 FDE: 17.281707763671875
Epoch 0 dtw: 35.54635441303253 inter ped distance mmd: nan
 
NaN or Inf found in input tensor.
Epoch 10 MSE: 4571.88330078125 MAE: 53.876197814941406
Epoch 10 OT: 1074.928591831125 MMD: 0.4741684559652274
Epoch 10 collision: 0.0 FDE: 21.717979431152344
Epoch 10 dtw: 35.118179619312286 inter ped distance mmd: nan
 
NaN or Inf found in input tensor.
Epoch 20 MSE: 4573.7880859375 MAE: 53.997989654541016
Epoch 20 OT: 1062.9199683466118 MMD: 0.47628435610438424
Epoch 20 collision: 2.0 FDE: 11.753364562988281
Epoch 20 dtw: 35.74996852874756 inter ped distance mmd: nan
 
NaN or Inf found in input tensor.
Epoch 30 MSE: 4567.84326171875 MAE: 53.96957778930664
Epoch 30 OT: 1054.6769856331732 MMD: 0.4723586491900954
Epoch 30 collision: 4.0 FDE: 11.627659797668457
Epoch 30 dtw: 35.72282099723816 inter ped distance mmd: nan
 
NaN or Inf found in input tensor.
