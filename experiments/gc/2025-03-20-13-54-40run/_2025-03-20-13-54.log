2025-03-20-13-54-40
Config:
('lr', 0.0005)
('nei_padding_mask', True)
('batch_size', 16)
('train_data_ratio', 1)
('diffusion_steps', 10)
('variance_mode', 'linear')
('val_mode', 'multistep')
('diffnet', 'Diffuser_ped_inter_geometric_cond_w_obs_w_history')
('yt_encoder_layers', 3)
('spatial_emsize', 128)
('spatial_encoder_head', 4)
('spatial_encoder_layers', 2)
('dropout', 0.3)
('esti_goal', 'acce')
('history_dim', 6)
('history_emsize', 64)
('history_lstm', 128)
('history_lstm_out', 64)
('ped_encode_dim1', 64)
('ped_encode_hid1', [64, 64])
('ped_encode_dim2', 64)
('ped_encode2_layers', 4)
('has_obstacles', True)
('egnn_layers', 3)
('egnn_hid_dim', 32)
('egnn_layers_obs', 1)
('egnn_hid_dim_obs', 32)
('diff_emb_hid', 64)
('diff_emb_out', 64)
('obs_seq_len', 8)
('pred_seq_len', 20)
('epochs', -1)
('save_model', True)
('finetune', True)
('total_epochs', 50)
('data_config', 'configs/data_configs/data_finetune_gc.yaml')
('rebuild_dataset', True)
('data_dict_path', 'dataset_built/pretrain_gc_1104_trainonreal_mt_fn10_t3v1.pkl')
('model_sd_path', False)
('finetune_trainmode', 'multistep')
('time_decay', 0.9)
('use_col_focus_loss', False)
('collision_threshold', 0.5)
('dataset_type', 'timeindex')
('finetune_flag', 1)
('valid_steps', 10)
('data_dir', 'processed_data_sf')
('topk_ped', 6)
('sight_angle_ped', 90)
('dist_threshold_ped', 4)
('topk_obs', 5)
('sight_angle_obs', 90)
('dist_threshold_obs', 4)
('skip_frames', 25)
('num_history_feature', 8)
('num_history_velocity', 1)
('train_mode', 'multi')
('eval_batch_size', 256)
('k_eval', 25)
('seed', 777)
('eval_every', 6)
('eval_at', 80)
('eval_mode', False)
('device', 'cuda')
('note', 'None')
('config', 'configs/gc.yaml')
('dataset', '')
('exp_name', 'gc')


Eval on:



#Trainable Parameters: 159434


('ft_lr', 5e-07)
Epoch 0 MSE: 4.461149215698242 MAE: 1.5076831579208374
Epoch 0 OT: 2.960654537168783 MMD: 0.03700929490166919
Epoch 0 collision: 1186.0 FDE: 1.4330520629882812
Epoch 0 dtw: 0.5777953627395881 inter ped distance mmd: 0.14652919652935928
 
Epoch 6 MSE: 4.276719570159912 MAE: 1.4767729043960571
Epoch 6 OT: 2.8780254292511573 MMD: 0.035104913529285714
Epoch 6 collision: 1158.0 FDE: 1.400357723236084
Epoch 6 dtw: 0.5649243090189544 inter ped distance mmd: 0.1457692062810638
 
Epoch 12 MSE: 4.092904567718506 MAE: 1.445573329925537
Epoch 12 OT: 2.8010435463541854 MMD: 0.03338695347268063
Epoch 12 collision: 1154.0 FDE: 1.4015458822250366
Epoch 12 dtw: 0.5511766835171954 inter ped distance mmd: 0.14120740622677136
 
Epoch 18 MSE: 3.954460382461548 MAE: 1.4197062253952026
Epoch 18 OT: 2.7432439219813984 MMD: 0.03196930382965189
Epoch 18 collision: 1220.0 FDE: 1.376846432685852
Epoch 18 dtw: 0.5400525673842395 inter ped distance mmd: 0.1395886394069543
 
Epoch 24 MSE: 3.804129123687744 MAE: 1.3881566524505615
Epoch 24 OT: 2.6703848915887205 MMD: 0.030540657062955796
Epoch 24 collision: 1242.0 FDE: 1.4082611799240112
Epoch 24 dtw: 0.5252253096438495 inter ped distance mmd: 0.14023956412977998
 
Epoch 30 MSE: 3.6841416358947754 MAE: 1.3648700714111328
Epoch 30 OT: 2.6222725327023415 MMD: 0.02932897164966121
Epoch 30 collision: 1210.0 FDE: 1.394031047821045
Epoch 30 dtw: 0.5161722773371871 inter ped distance mmd: 0.1399171920955058
 
Epoch 36 MSE: 3.577174425125122 MAE: 1.3442058563232422
Epoch 36 OT: 2.5669342072449046 MMD: 0.028159717749547696
Epoch 36 collision: 1238.0 FDE: 1.3789869546890259
Epoch 36 dtw: 0.5073244459141629 inter ped distance mmd: 0.13920932910443584
 
Epoch 42 MSE: 3.483320951461792 MAE: 1.3245079517364502
Epoch 42 OT: 2.5143578626409804 MMD: 0.02715344274462747
Epoch 42 collision: 1212.0 FDE: 1.367611289024353
Epoch 42 dtw: 0.4989642141925463 inter ped distance mmd: 0.13526646462307612
 
Epoch 48 MSE: 3.403076410293579 MAE: 1.30802583694458
Epoch 48 OT: 2.4725589713619858 MMD: 0.0262527482445575
Epoch 48 collision: 1226.0 FDE: 1.3454394340515137
Epoch 48 dtw: 0.49147893736385795 inter ped distance mmd: 0.13669259358997926
 
